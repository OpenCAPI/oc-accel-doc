<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>(1) Prepare environment - OC-Accel Doc</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <link href="../../extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">OC-Accel Doc</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../..">Overview</a>
</li>
                                    
<li >
    <a href="../../repository/">About the repository</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../0-steps/">(0) Steps in a glance</a>
</li>
                                    
<li class="active">
    <a href="./">(1) Prepare environment</a>
</li>
                                    
<li >
    <a href="../2-run-helloworld/">(2) Run helloworld</a>
</li>
                                    
<li >
    <a href="../3-new-action/">(3) Create a new action</a>
</li>
                                    
<li >
    <a href="../4-hdl-design/">(4) Verilog/VHDL design</a>
</li>
                                    
<li >
    <a href="../5-hls-design/">(5) HLS C++ design</a>
</li>
                                    
<li >
    <a href="../6-co-simulation/">(6) Co-Simulation</a>
</li>
                                    
<li >
    <a href="../7-build-image/">(7) Build image</a>
</li>
                                    
<li >
    <a href="../8-deploy/">(8) Deploy on Power Server</a>
</li>
                                    
<li >
    <a href="../9-migrate/">(9) Migrate from SNAP1/2</a>
</li>
                                    
<li >
    <a href="../10-tips/">(10) Tips</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../actions-doc/hdl_example/">hdl_example</a>
</li>
                                    
<li >
    <a href="../../actions-doc/hdl_single_engine/">hdl_single_engine</a>
</li>
                                    
<li >
    <a href="../../actions-doc/hls_helloworld/">hls_helloworld</a>
</li>
                                    
<li >
    <a href="../../actions-doc/hls_memcopy_1024/">hls_memcopy_1024</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Deep Dive <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../deep-dive/software-api/">Software API</a>
</li>
                                    
<li >
    <a href="../../deep-dive/registers/">Registers</a>
</li>
                                    
<li >
    <a href="../../deep-dive/hardware-logic/">Hardware Logic</a>
</li>
                                    
<li >
    <a href="../../deep-dive/board-package/">New Board Support</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Misc <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../misc/doc-guide/">Document Guide</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../0-steps/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../2-run-helloworld/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li>
                                <a href="https://github.com/OpenCAPI/oc-accel"><i class="fa fa-github"></i> GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#prepare-environment">Prepare Environment</a></li>
            <li><a href="#basic-tools">Basic Tools</a></li>
            <li><a href="#clone-github-repositories">Clone Github Repositories</a></li>
        <li class="main "><a href="#basic-terms">Basic terms</a></li>
            <li><a href="#option1-all-in-one-python-script">Option1: All-in-one python script</a></li>
            <li><a href="#option2-traditional-make-steps">Option2: Traditional "make" steps</a></li>
            <li><a href="#output-files">Output files</a></li>
        <li class="main "><a href="#lets-go">Let's go!</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<p>This page will introduce the basic environmental requests, tools, and general commands to run OC-Accel flow.</p>
<h1 id="prepare-environment">Prepare Environment</h1>
<h2 id="basic-tools">Basic Tools</h2>
<p>Firstly, you need to have an x86 machine for development with <a href="https://www.xilinx.com/support/download.html">Vivado Tool</a> and the license.</p>
<pre><code>export XILINX_VIVADO=&lt;...path...&gt;/Xilinx/Vivado/&lt;VERSION&gt;
export XILINXD_LICENSE_FILE=&lt;pointer to Xilinx license&gt;
export PATH=$PATH:${XILINX_VIVADO}/bin
</code></pre>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OC-Accel works on Vivado 2018.2, 2018.3 and 2019.1</p>
<p>For AD9H3 and AD9H7 cards with HBM, Vivado version is at least 2018.3</p>
</div>
<p>There is a file <code>setup_tools.ksh</code> in the root directory for reference. But for the beginning, only Vivado is required.</p>
<p>Make sure you have <code>gcc</code>, <code>make</code>, <code>sed</code>, <code>awk</code>, <code>xterm</code> and <code>python</code> installed.
<code>setup_tools.ksh</code></p>
<p>You may install other simulators to accelerate the speed of simulation. For example, <a href="https://www.cadence.com/content/cadence-www/global/en_US/home/tools/system-design-and-verification/simulation-and-testbench-verification/xcelium-parallel-simulator.html">Cadence xcelium</a>. See in <a href="../6-co-simulation/">co-simulation</a> for more information.</p>
<h2 id="clone-github-repositories">Clone Github Repositories</h2>
<p>TODO: Link to update</p>
<pre><code>git clone git@github.com:OpenCAPI/oc-accel.git
cd oc-accel
git submodule init
git submodule update

cd ..
git clone git@github.com:OpenCAPI/ocse.git
</code></pre>

<p>It's better to have <code>ocse</code> stay in the same directory parallel to <code>oc-accel</code>. That is the default path of <code>$OCSE_ROOT</code>. Or you need to assign <code>$OCSE_ROOT</code> explicitly in <code>snap_env.sh</code>.</p>
<h1 id="basic-terms">Basic terms</h1>
<h2 id="option1-all-in-one-python-script">Option1: All-in-one python script</h2>
<p>OC-Accel developed a "all-in-one" Python script to control the workflow. It's convenient to do batch work, or enable your regression verification or continuous integration.</p>
<pre><code>cd oc-accel
./ocaccel_workflow.py
</code></pre>

<p>This script will</p>
<ul>
<li>Check environmental variables</li>
<li>make snap_config</li>
<li>build model</li>
<li>start simulation</li>
</ul>
<p>There are many options provided by <code>ocaccel_workflow.py</code>. Check the help messages by</p>
<pre><code>./ocaccel_workflow.py --help
</code></pre>

<p>It helps you to do all kinds of operations in one command line.</p>
<h2 id="option2-traditional-make-steps">Option2: Traditional "make" steps</h2>
<p>If you have used SNAP for CAPI1.0 and CAPI2.0, you can continue to use these "traditional" make steps. Just typing "make" doesn't work. An explicit target is needed. You can find them in <code>Makefile</code> file.</p>
<pre><code>cd oc-accel
make help
</code></pre>

<pre><code>Main targets for the SNAP Framework make process:
=================================================
* snap_config    Configure SNAP framework
* model          Build simulation model for simulator specified via target snap_config
* sim            Start a simulation
* sim_tmux       Start a simulation in tmux (no xterm window popped up)
* hw_project     Create Vivado project with oc-bip
* image          Build a complete FPGA bitstream after hw_project (takes more than one hour)
* hardware       One step to build FPGA bitstream (Combines targets 'model' and 'image')
* software       Build software libraries and tools for SNAP
* apps           Build the applications for all actions
* clean          Remove all files generated in make process
* clean_config   As target 'clean' plus reset of the configuration
* help           Print this message



The hardware related targets 'model', 'image', 'hardware', 'hw_project' and 'sim'
do only exist on an x86 platform
</code></pre>

<h3 id="for-simulation">For simulation</h3>
<ul>
<li><code>make snap_config</code></li>
<li><code>make model</code></li>
<li><code>make sim</code></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After <code>make model</code>,  you can continue to run <code>make image</code> to generate bitstreams.</p>
</div>
<p>In fact, <code>make model</code> also creates a Vivado project <code>framework.xpr</code> in <code>hardware/viv_project</code>. Then it exports the simulation files and compiles them to a simulation model.</p>
<h3 id="for-image-build">For Image build</h3>
<ul>
<li><code>make snap_config</code> If it has already been executed, no need to run it again.</li>
<li><code>make hw_project</code></li>
<li><code>make image</code></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Use Vivado GUI</strong>:</p>
<p>After <code>make hw_project</code>, you can open project <code>framework.xpr</code> in <code>hardware/viv_project</code>, and do following <strong>"run Synthesis"</strong>, <strong>"run Implementation"</strong> and <strong>"generate Bitstream"</strong> in Vivado GUI.</p>
</div>
<h2 id="output-files">Output files</h2>
<ul>
<li>
<p>The log files during these steps are placed in <code>hardware/logs</code>.</p>
</li>
<li>
<p>Simulation output files are placed in <code>hardware/sim/&lt;SIMULATOR&gt;/latest</code>.</p>
</li>
<li>
<p>If you are using <code>make image</code> to generate bitstreams, the outputs are in <code>hardware/build</code>, including <code>Images</code>, <code>Reports</code> and <code>Checkpoints</code>.</p>
</li>
<li>
<p>If you are using Vivado Gui mode to generate bitstream, the outputs are in <code>hardware/viv_project/framework.runs</code>, including <code>synth_1</code> and <code>impl_1</code>, etc.</p>
</li>
</ul>
<h1 id="lets-go">Let's go!</h1>
<p>Now, let's take an example <code>hls_helloworld</code>, and have a look at how it runs step by step. Please continue to read page <a href="../2-run-helloworld/">Run helloworld</a>.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../extra.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
